<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sarat Office ¬∑ Isolated Tabs (Header/Footer safe)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Papaparse for CSV parsing -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<!-- Common CSS -->
    <link rel="stylesheet" href="style.css">
      <style>
    /* ----- NAMESPACED WRAPPER ‚Äì all custom CSS is scoped inside .sarat-docs ----- */
.sarat-docs {
  display: block;
  width: 100%;
  max-width: 1600px;
  margin: 0 auto;
  padding: 20px 60px;
  box-sizing: border-box;
}

/* ---- HORIZONTAL TABS ‚Äì RECTANGULAR 3D STYLE (EXACTLY AS IMAGE) ---- */
.sarat-docs .tab-strip {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 16px;
  background: transparent;
  padding: 20px 0;
  margin: 20px 0 40px 0;
  border-bottom: none;
}

/* tab item ‚Äî rectangular with 3D depth */
.sarat-docs .tab-item {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 14px 32px;
  font-size: 1.1rem;
  font-weight: 600;
  letter-spacing: 0.5px;
  color: #1e3a5f;
  background: #ffffff;
  border: none;
  border-radius: 0;
  box-shadow: 
    0 6px 0 #b0b0b0,
    0 8px 12px rgba(0,0,0,0.15),
    inset 0 -2px 0 rgba(0,0,0,0.05);
  transition: all 0.15s ease;
  cursor: pointer;
  text-decoration: none;
  text-transform: uppercase;
  border: 1px solid #d0d0d0;
  border-bottom: none;
  min-width: 140px;
}

/* hover effect ‚Äî lift and stronger shadow */
.sarat-docs .tab-item:hover {
  transform: translateY(-2px);
  box-shadow: 
    0 8px 0 #8a8a8a,
    0 12px 20px rgba(0,0,0,0.2),
    inset 0 -2px 0 rgba(0,0,0,0.05);
  background: #f8fbff;
  color: #0a2a44;
}

/* ACTIVE tab ‚Äî rich blue, white text, deeper 3D */
.sarat-docs .tab-item.active {
  background: #005a9c;
  color: white !important;
  box-shadow: 
    0 6px 0 #003f6b,
    0 10px 16px rgba(0,90,156,0.3),
    inset 0 -2px 0 rgba(0,0,0,0.1);
  border-color: #004a80;
  border-bottom: none;
  transform: translateY(0);
}

.sarat-docs .tab-item.active:hover {
  background: #004a80;
  box-shadow: 
    0 8px 0 #003050,
    0 14px 22px rgba(0,70,130,0.35);
  transform: translateY(-2px);
  color: white;
}

/* remove dividers/dots completely */
.sarat-docs .tab-divider {
  display: none;
}

/* ----- 3D TABLE ‚Äì WIDER, FULL WIDTH, CENTERED CONTENT ----- */
.sarat-docs .csv-tab-container {
  overflow-x: auto;
  padding: 20px 0 40px 0;
  background: transparent;
  margin-top: 10px;
}

.sarat-docs .csv-table {
  width: 80%;
  border-collapse: separate;
  border-spacing: 0;
  font-family: 'Segoe UI', sans-serif;
  font-size: 16px;
  min-width: 600px;
  border-radius: 8px;
  overflow: hidden;
  background: #ffffff;
  box-shadow:
    0 0 0 4px #e8f0fe,
    0 8px 20px rgba(0, 80, 150, 0.2),
    inset 0 0 6px rgba(0, 120, 210, 0.1);
  margin: 0 auto;
}

.sarat-docs .csv-table thead {
  background: linear-gradient(135deg, #0a1e3c, #13294b);
}

.sarat-docs .csv-table thead th {
  color: #fff !important;
  font-weight: 700;
  text-align: center;
  padding: 20px 18px;
  letter-spacing: 0.8px;
  font-size: 16px;
  text-transform: uppercase;
}

.sarat-docs .csv-table td {
  padding: 18px 20px;
  border-bottom: 1px solid #d4e3f0;
  vertical-align: middle;
  background-color: white;
  font-size: 15px;
}

.sarat-docs .csv-table td:nth-child(1) {
  text-align: center;
  font-weight: 600;
  color: #0a2e4a;
  width: 80px;
}

.sarat-docs .csv-table td:nth-child(2) {
  text-align: left;
  font-weight: 500;
  color: #1e3a5f;
}

.sarat-docs .csv-table td:nth-child(3),
.sarat-docs .csv-table td:nth-child(4) {
  text-align: center;
  width: 140px;
}

.sarat-docs .csv-table tbody tr:hover {
  background-color: #f0f9ff;
  transition: background-color 0.15s;
  box-shadow: inset 0 0 0 2px rgba(0,110,220,0.1);
}

.sarat-docs .csv-table tbody tr:hover td {
  background-color: #f0f9ff;
}

/* --- 3D BUTTONS ‚Äì refined, consistent --- */
.sarat-docs .download-btn,
.sarat-docs .share-btn {
  min-width: 120px;
  padding: 12px 20px;
  font-size: 14px;
  font-weight: 700;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  color: white;
  text-shadow: 0 1px 2px rgba(0,0,0,0.2);
  box-shadow:
    inset 0 -3px 0 rgba(0,0,0,0.15),
    0 5px 12px rgba(0,0,0,0.12);
  transform: translateY(0);
  transition: all 0.2s ease;
  letter-spacing: 0.8px;
  text-transform: uppercase;
}

.sarat-docs .download-btn {
  background: linear-gradient(to bottom, #2e7d32, #1b5e20);
}

.sarat-docs .download-btn:hover {
  background: linear-gradient(to bottom, #1b5e20, #0e4212);
  transform: translateY(-2px);
  box-shadow:
    inset 0 -3px 0 rgba(0,0,0,0.2),
    0 8px 18px rgba(46,125,50,0.4);
}

.sarat-docs .share-btn {
  background: linear-gradient(to bottom, #1976d2, #0d47a1);
}

.sarat-docs .share-btn:hover {
  background: linear-gradient(to bottom, #0d47a1, #062a5c);
  transform: translateY(-2px);
  box-shadow:
    inset 0 -3px 0 rgba(0,0,0,0.2),
    0 8px 18px rgba(25,118,210,0.4);
}

/* remove any lingering dot dividers */
.sarat-docs .tab-divider {
  display: none !important;
}

/* responsive adjustments */
@media (max-width: 1100px) {
  .sarat-docs {
    padding: 20px 30px;
  }
  
  .sarat-docs .tab-item {
    padding: 12px 24px;
    min-width: 120px;
    font-size: 1rem;
  }
}

@media (max-width: 800px) {
  .sarat-docs {
    padding: 15px 20px;
  }
  
  .sarat-docs .tab-strip {
    gap: 12px;
  }
  
  .sarat-docs .tab-item {
    padding: 10px 18px;
    min-width: 100px;
    font-size: 0.9rem;
  }
  
  .sarat-docs .csv-table {
    min-width: 700px;
  }
}
  </style>
</head>
<body>

<!-- ===== YOUR HEADER ‚Äì completely untouched ===== -->
<div id="site-header"></div>

<!-- ===== MAIN DOCS COMPONENT ‚Äì everything inside .sarat-docs ===== -->
<div class="sarat-docs">

  <!-- Horizontal tab strip ‚Äì categories exactly as per image + your list -->
  <div class="tab-strip" id="horizontalTabStrip">
    <button class="tab-item active" data-category="Act">ACTS</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Rules">RULES</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Order">ORDERS</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="MSP">PADDY MSP</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Procurement">PROC GUIDELINES</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Food">FOOD POLICY</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Misc">MISCELLANEOUS</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Govt Calendars">GOVT. CALENDARS</button>
  </div>

  <!-- Dynamic table area ‚Äì each container ID matches the updated category names -->
  <div id="dynamicTableArea">
    <div class="csv-tab-container" id="tab-Act" style="display: block;">
      <div class="csv-table-placeholder">Loading Acts...</div>
    </div>
    <div class="csv-tab-container" id="tab-Rules" style="display: none;">
      <div class="csv-table-placeholder">Loading Rules...</div>
    </div>
    <div class="csv-tab-container" id="tab-Order" style="display: none;">
      <div class="csv-table-placeholder">Loading Orders...</div>
    </div>
    <div class="csv-tab-container" id="tab-MSP" style="display: none;">
      <div class="csv-table-placeholder">Loading Paddy MSP...</div>
    </div>
    <div class="csv-tab-container" id="tab-Procurement" style="display: none;">
      <div class="csv-table-placeholder">Loading Proc Guidelines...</div>
    </div>
    <div class="csv-tab-container" id="tab-Food" style="display: none;">
      <div class="csv-table-placeholder">Loading Food Policy...</div>
    </div>
    <div class="csv-tab-container" id="tab-Misc" style="display: none;">
      <div class="csv-table-placeholder">Loading Miscellaneous...</div>
    </div>
    <div class="csv-tab-container" id="tab-Govt Calendars" style="display: none;">
      <div class="csv-table-placeholder">Loading Govt. Calendars...</div>
    </div>
  </div>

</div> <!-- end .sarat-docs -->

<!-- ===== YOUR FOOTER ‚Äì completely untouched ===== -->
<div id="site-footer"></div>

<script>
  (function() {
    "use strict";

    // ------- CSV FETCH -------
    const CSV_URL = "https://docs.google.com/spreadsheets/d/1mLh8E5JEHP-HCrBgs42pVpiY4ZpP7LG-O__3Av2-MgY/export?format=csv&gid=884226509";
    let parsedRows = [];

    // ---------- FETCH AND POPULATE ALL TABLES (UPDATED CATEGORY NAMES) ----------
    function loadAllCSVTables() {
      fetch(CSV_URL)
        .then(response => response.text())
        .then(csvText => {
          const parsed = Papa.parse(csvText, { header: false });
          const rows = parsed.data.slice(1); // skip header row
          parsedRows = rows.filter(row => row && row.length > 1);

          /* --- REPLACED CATEGORIES --- */
          populateTableForCategory('Act');
          populateTableForCategory('Rules');
          populateTableForCategory('Order');
          populateTableForCategory('MSP');           // was 'Paddy MSP'
          populateTableForCategory('Procurement');   // was 'Proc Guidelines'
          populateTableForCategory('Food');          // was 'Food Policy'
          populateTableForCategory('Misc');          // was 'Miscellaneous'
          populateTableForCategory('Govt Calendars');
        })
        .catch(err => {
          console.error("CSV Load Error:", err);
          document.querySelectorAll('.sarat-docs .csv-table-placeholder').forEach(el => {
            el.innerHTML = `<span style="color: red;">‚ö†Ô∏è Failed to load data.</span>`;
          });
        });
    }

    // build table HTML for a given category
    function buildTableHTML(category) {
      const filtered = parsedRows.filter(row => row[1] && row[1].trim() === category);
      if (filtered.length === 0) {
        return `<table class="csv-table"><thead><tr><th>S.No.</th><th>Subject</th><th>Download</th><th>Share</th></tr></thead><tbody><tr><td colspan="4" style="text-align:center; padding:40px;">üìÅ No documents for ${category}</td></tr></tbody></table>`;
      }

      const rowsHtml = filtered.map((row, idx) => {
        let subject = (row[2] || "").replace(/_/g, " ").replace(/\.pdf$/i, "").trim();
        if (subject === "") subject = "Untitled";
        const link = row[5] ? row[5].trim() : "#";
        const safeLink = (link.startsWith("http") || link.startsWith("/")) ? link : "#";
        const encodedSubject = encodeURIComponent("üìÑ " + subject + "\nüîó " + safeLink);
        return `<tr>
          <td>${idx + 1}</td>
          <td>${subject}</td>
          <td><a href="${safeLink}" target="_blank"><button class="download-btn">Download</button></a></td>
          <td><a href="https://wa.me/?text=${encodedSubject}" target="_blank"><button class="share-btn">Share</button></a></td>
        </tr>`;
      }).join("");

      return `<table class="csv-table">
        <thead><tr><th>S.No.</th><th>Subject</th><th>Download</th><th>Share</th></tr></thead>
        <tbody>${rowsHtml}</tbody>
      </table>`;
    }

    function populateTableForCategory(category) {
      const tabDiv = document.getElementById(`tab-${category}`);
      if (!tabDiv) {
        console.warn(`Container for category "${category}" not found.`);
        return;
      }
      const placeholder = tabDiv.querySelector('.csv-table-placeholder');
      if (!placeholder) return;
      if (parsedRows.length === 0) {
        placeholder.innerHTML = '‚è≥ Loading...';
        return;
      }
      placeholder.innerHTML = buildTableHTML(category);
    }

    // ---------- TAB CLICK HANDLER (updated container IDs) ----------
    function initTabs() {
      const tabStrip = document.querySelector('.sarat-docs .tab-strip');
      if (!tabStrip) return;
      const tabButtons = tabStrip.querySelectorAll('.tab-item');
      
      const containers = {
        Act: document.getElementById('tab-Act'),
        Rules: document.getElementById('tab-Rules'),
        Order: document.getElementById('tab-Order'),
        MSP: document.getElementById('tab-MSP'),
        Procurement: document.getElementById('tab-Procurement'),
        Food: document.getElementById('tab-Food'),
        Misc: document.getElementById('tab-Misc'),
        'Govt Calendars': document.getElementById('tab-Govt Calendars')
      };

      function activateTab(category) {
        // update active class on buttons
        tabButtons.forEach(btn => {
          const btnCat = btn.getAttribute('data-category');
          btn.classList.toggle('active', btnCat === category);
        });

        // show/hide containers
        Object.keys(containers).forEach(key => {
          if (containers[key]) {
            containers[key].style.display = key === category ? 'block' : 'none';
          }
        });

        // ensure table is built if needed
        if (parsedRows.length > 0) {
          const target = containers[category];
          if (target) {
            const placeholder = target.querySelector('.csv-table-placeholder');
            if (placeholder && placeholder.innerHTML.includes('Loading')) {
              placeholder.innerHTML = buildTableHTML(category);
            }
          }
        }
      }

      tabButtons.forEach(btn => {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          const category = this.getAttribute('data-category');
          activateTab(category);
        });
      });

      // initial active = Act
      activateTab('Act');
    }

    // ----- HEADER / FOOTER LOADER (unchanged, safe) -----
    function loadHeaderFooter() {
      const headerEl = document.getElementById('site-header');
      const footerEl = document.getElementById('site-footer');

      Promise.all([
        fetch('header.html').catch(() => ({ ok: false })),
        fetch('footer.html').catch(() => ({ ok: false }))
      ]).then(responses => {
        if (responses[0] && responses[0].ok) {
          responses[0].text().then(html => { headerEl.innerHTML = html; });
        } else {
          headerEl.innerHTML = '<div class="fallback-header">üìò SARAT OFFICE</div>';
        }

        if (responses[1] && responses[1].ok) {
          responses[1].text().then(html => { footerEl.innerHTML = html; });
        } else {
          footerEl.innerHTML = '<div class="fallback-footer">¬© Sarat Government Office ‚Äî eDocuments</div>';
        }
      });

      fetch('nav.html')
        .then(res => res.ok ? res.text() : '')
        .then(navHtml => {
          const navTarget = document.getElementById('main-nav');
          if (navTarget && navHtml) navTarget.innerHTML = navHtml;
        })
        .catch(() => {});
    }

    // ----- START -----
    loadHeaderFooter();
    loadAllCSVTables();
    initTabs();

    // Mobile dropdown logic (global, unaffected)
    document.addEventListener("click", function (e) {
      if (e.target.classList.contains("menu-toggle")) {
        const menu = document.querySelector(".menu");
        if (menu) menu.classList.toggle("open");
      }
      const dropdownLink = e.target.closest(".dropdown > a");
      if (dropdownLink && window.innerWidth <= 900) {
        e.preventDefault();
        dropdownLink.parentElement.classList.toggle("open");
      }
    });

  })();
</script>

</body>
</html>
