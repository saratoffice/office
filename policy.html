<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sarat Office ¬∑ Govt. Calendars Tab</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Papaparse for CSV parsing -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<!-- Common CSS -->
    <link rel="stylesheet" href="style.css">
  <script src="assets/Scripts/site-components.js" defer></script>
  <style>
    /* ================================
   GUARD FILE ‚Äì HERO SECTION
   ================================ */

.guard-hero {
  /* Gradient background */
  background: linear-gradient(
    135deg,
    #243b55 0%,
    #29485a 50%,
    #1f3a4a 100%
  );
  padding: 50px 20px;
  text-align: center;
  color: #ffffff;
  overflow: hidden;
}

.guard-hero-inner {
  max-width: 1100px;
  margin: auto;
}

/* Title */
.guard-title {
  font-size: 56px;
  font-weight: 800;
  letter-spacing: 3px;
  color: #fff176;
  margin-bottom: 20px;
  text-transform: uppercase;
}

/* Subtitle */
.guard-subtitle {
  font-size: 26px;
  color: #9adfff;
  margin-bottom: 40px;
  font-weight: 500;
}

/* Buttons */
.guard-actions {
  display: flex;
  justify-content: center;
  gap: 20px;
  flex-wrap: wrap;
}

.guard-btn {
  padding: 14px 34px;
  border-radius: 10px;
  font-size: 18px;
  font-weight: 600;
  text-decoration: none;
  color: #ffffff;
  background: transparent;
  border: 2px solid #ffffff;
  transition: all 0.3s ease;
}

.guard-btn:hover {
  background: #ffffff;
  color: #1f3a4a;
  transform: translateY(-3px);
}

/* Secondary button */
.guard-btn.outline {
  border-color: #9adfff;
  color: #9adfff;
}

.guard-btn.outline:hover {
  background: #9adfff;
  color: #1f2937;
}

/* ================================
   SCROLL ANIMATION
   ================================ */

.animate-on-scroll {
  opacity: 0;
  transform: translateY(40px);
  transition: opacity 0.9s ease, transform 0.9s ease;
}

.animate-on-scroll.visible {
  opacity: 1;
  transform: translateY(0);
}

/* ================================
   RESPONSIVE
   ================================ */

@media (max-width: 768px) {
  .guard-title {
    font-size: 38px;
  }

  .guard-subtitle {
    font-size: 20px;
  }

  .guard-btn {
    font-size: 16px;
    padding: 12px 26px;
  }
}

    /* ----- GLOBAL RESET ----- */
    body {
      margin: 0;
      background: #f5f9ff;
      font-family: 'Segoe UI', Roboto, sans-serif;
    }

    /* ----- NAMESPACED WRAPPER ‚Äì all custom CSS is scoped inside .sarat-docs ----- */
    .sarat-docs {
      display: block;
      width: 100%;
      max-width: 1800px;
      margin: 0 auto;
      padding: 20px 80px;
      box-sizing: border-box;
    }

    /* ---- HORIZONTAL TABS ‚Äì RECTANGULAR 3D STYLE (EXACTLY AS IMAGE) ---- */
    .sarat-docs .tab-strip {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: center;
      gap: 20px;
      background: transparent;
      padding: 25px 0;
      margin: 20px 0 40px 0;
      border-bottom: none;
    }

    .sarat-docs .tab-item {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 16px 36px;
      font-size: 1.2rem;
      font-weight: 700;
      letter-spacing: 0.8px;
      color: #1e3a5f;
      background: #ffffff;
      border: none;
      border-radius: 0;
      box-shadow: 
        0 8px 0 #a0a0a0,
        0 10px 15px rgba(0,0,0,0.2),
        inset 0 -2px 0 rgba(0,0,0,0.05);
      transition: all 0.15s ease;
      cursor: pointer;
      text-decoration: none;
      text-transform: uppercase;
      border: 1px solid #c0c0c0;
      border-bottom: none;
      min-width: 160px;
    }

    .sarat-docs .tab-item:hover {
      transform: translateY(-4px);
      box-shadow: 
        0 10px 0 #7a7a7a,
        0 15px 25px rgba(0,0,0,0.25),
        inset 0 -2px 0 rgba(0,0,0,0.05);
      background: #f0f7ff;
      color: #003366;
    }

    .sarat-docs .tab-item.active {
      background: #0066b3;
      color: white !important;
      box-shadow: 
        0 8px 0 #00407a,
        0 12px 20px rgba(0,102,179,0.35),
        inset 0 -2px 0 rgba(0,0,0,0.15);
      border-color: #005095;
      border-bottom: none;
      transform: translateY(0);
    }

    .sarat-docs .tab-item.active:hover {
      background: #005095;
      box-shadow: 
        0 10px 0 #00355c,
        0 18px 28px rgba(0,80,150,0.4);
      transform: translateY(-3px);
      color: white;
    }

    .sarat-docs .tab-divider {
      display: none !important;
    }

    /* ----- CSV TABLE STYLES - 80% WIDTH AS REQUESTED ----- */
    .sarat-docs .csv-tab-container {
      overflow-x: auto;
      padding: 20px 0 40px 0;
      background: transparent;
      margin-top: 10px;
      display: flex;
      justify-content: center;
    }

    .sarat-docs .csv-table {
      width: 80%;
      border-collapse: separate;
      border-spacing: 0;
      font-family: 'Segoe UI', sans-serif;
      font-size: 16px;
      min-width: 600px;
      border-radius: 8px;
      overflow: hidden;
      background: #ffffff;
      box-shadow:
        0 0 0 4px #e8f0fe,
        0 8px 20px rgba(0, 80, 150, 0.2),
        inset 0 0 6px rgba(0, 120, 210, 0.1);
      margin: 0 auto;
    }

    .sarat-docs .csv-table thead {
      background: linear-gradient(135deg, #0a1e3c, #13294b);
    }

    .sarat-docs .csv-table thead th {
      color: #fff !important;
      font-weight: 700;
      text-align: center;
      padding: 20px 18px;
      letter-spacing: 0.8px;
      font-size: 16px;
      text-transform: uppercase;
    }

    .sarat-docs .csv-table td {
      padding: 18px 20px;
      border-bottom: 1px solid #d4e3f0;
      vertical-align: middle;
      background-color: white;
      font-size: 15px;
    }

    .sarat-docs .csv-table td:nth-child(1) {
      text-align: center;
      font-weight: 600;
      color: #0a2e4a;
      width: 80px;
    }

    .sarat-docs .csv-table td:nth-child(2) {
      text-align: left;
      font-weight: 500;
      color: #1e3a5f;
    }

    .sarat-docs .csv-table td:nth-child(3),
    .sarat-docs .csv-table td:nth-child(4) {
      text-align: center;
      width: 140px;
    }

    .sarat-docs .csv-table tbody tr:hover {
      background-color: #f0f9ff;
      transition: background-color 0.15s;
    }

    .sarat-docs .download-btn,
    .sarat-docs .share-btn {
      min-width: 120px;
      padding: 12px 20px;
      font-size: 14px;
      font-weight: 700;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      color: white;
      text-shadow: 0 1px 2px rgba(0,0,0,0.2);
      box-shadow:
        inset 0 -3px 0 rgba(0,0,0,0.15),
        0 5px 12px rgba(0,0,0,0.12);
      transform: translateY(0);
      transition: all 0.2s ease;
      letter-spacing: 0.8px;
      text-transform: uppercase;
    }

    .sarat-docs .download-btn {
      background: linear-gradient(to bottom, #2e7d32, #1b5e20);
    }

    .sarat-docs .download-btn:hover {
      background: linear-gradient(to bottom, #1b5e20, #0e4212);
      transform: translateY(-2px);
      box-shadow:
        inset 0 -3px 0 rgba(0,0,0,0.2),
        0 8px 18px rgba(46,125,50,0.4);
    }

    .sarat-docs .share-btn {
      background: linear-gradient(to bottom, #1976d2, #0d47a1);
    }

    .sarat-docs .share-btn:hover {
      background: linear-gradient(to bottom, #0d47a1, #062a5c);
      transform: translateY(-2px);
      box-shadow:
        inset 0 -3px 0 rgba(0,0,0,0.2),
        0 8px 18px rgba(25,118,210,0.4);
    }
/* ----- GOVT. CALENDARS TABLE - FIX COLUMN WIDTHS (AS IN IMAGE) ----- */
.sarat-docs #tab-Govt\ Calendars .csv-table {
  width: 80%;
  table-layout: fixed; /* Enforces exact column widths */
}

/* Calendar Year column - WIDE, proper spacing */
.sarat-docs #tab-Govt\ Calendars .csv-table th:nth-child(1),
.sarat-docs #tab-Govt\ Calendars .csv-table td:nth-child(1) {
  width: 35% !important;      /* Takes proper width like in your image */
  min-width: 220px !important;
  text-align: left !important; /* Left-aligned as shown in image */
  padding-left: 30px !important;
}

/* PDF column */
.sarat-docs #tab-Govt\ Calendars .csv-table th:nth-child(2),
.sarat-docs #tab-Govt\ Calendars .csv-table td:nth-child(2) {
  width: 32.5% !important;
  text-align: center !important;
}

/* JPG column */
.sarat-docs #tab-Govt\ Calendars .csv-table th:nth-child(3),
.sarat-docs #tab-Govt\ Calendars .csv-table td:nth-child(3) {
  width: 32.5% !important;
  text-align: center !important;
}

/* Ensure header text aligns with column content */
.sarat-docs #tab-Govt\ Calendars .csv-table th:nth-child(1) {
  text-align: left !important;
  padding-left: 30px !important;
}

/* Remove any conflicting table-layout from parent */
.sarat-docs #tab-Govt\ Calendars .csv-table {
  table-layout: fixed !important;
}
    /* fallback header/footer */
    .fallback-header {
      background: #0c1f33;
      color: white;
      padding: 18px 30px;
      font-size: 24px;
      font-weight: bold;
    }
    .fallback-footer {
      background: #0a1929;
      color: #bbd6ff;
      padding: 20px 30px;
      text-align: center;
    }

    @media (max-width: 1200px) {
      .sarat-docs {
        padding: 20px 50px;
      }
      .sarat-docs .tab-item {
        padding: 14px 28px;
        min-width: 140px;
        font-size: 1.1rem;
      }
      .sarat-docs .csv-table {
        width: 90%;
      }
    }

    @media (max-width: 900px) {
      .sarat-docs {
        padding: 15px 20px;
      }
      .sarat-docs .tab-strip {
        gap: 15px;
      }
      .sarat-docs .tab-item {
        padding: 12px 20px;
        min-width: 120px;
        font-size: 1rem;
      }
      .sarat-docs .csv-table {
        width: 95%;
      }
    }

    @media (max-width: 768px) {
      .sarat-docs .csv-table {
        width: 100%;
      }
    }
  </style>
</head>
<body>

<!-- HEADER -->
<div id="site-header"></div>

<!-- MAIN DOCS COMPONENT -->
  <section class="guard-hero">

  <div class="guard-hero-inner animate-on-scroll">

    <h1 class="guard-title">GUARD FILE</h1>

    <p class="guard-subtitle">
      Government Letters and Guidelines Archive
    </p>

    <div class="guard-actions">
      <a href="guard-file.html" class="guard-btn">Guidelines</a>
      <a href="guard-file.html" class="guard-btn outline">Circulars</a>
    </div>

  </div>
</section>
<script src="assets/Scripts/Guardfile-animations.js"></script>
  
<div class="sarat-docs">

  <!-- Horizontal tab strip ‚Äì RECTANGULAR, 3D, NO DOTS, PROPER GAP -->
  <div class="tab-strip" id="horizontalTabStrip">
    <button class="tab-item active" data-category="Act">ACTS</button>
    <button class="tab-item" data-category="Rules">RULES</button>
    <button class="tab-item" data-category="Order">ORDERS</button>
    <button class="tab-item" data-category="MSP">PADDY MSP</button>
    <button class="tab-item" data-category="Procurement">PROC GUIDELINES</button>
    <button class="tab-item" data-category="Food">FOOD POLICY</button>
    <button class="tab-item" data-category="Misc">MISCELLANEOUS</button>
    <button class="tab-item" data-category="Govt Calendars">GOVT. CALENDARS</button>
  </div>

  <!-- Dynamic table area -->
  <div id="dynamicTableArea">
    <!-- CSV-based tabs -->
    <div class="csv-tab-container" id="tab-Act" style="display: block;">
      <div class="csv-table-placeholder">Loading Acts...</div>
    </div>
    <div class="csv-tab-container" id="tab-Rules" style="display: none;">
      <div class="csv-table-placeholder">Loading Rules...</div>
    </div>
    <div class="csv-tab-container" id="tab-Order" style="display: none;">
      <div class="csv-table-placeholder">Loading Orders...</div>
    </div>
    <div class="csv-tab-container" id="tab-MSP" style="display: none;">
      <div class="csv-table-placeholder">Loading Paddy MSP...</div>
    </div>
    <div class="csv-tab-container" id="tab-Procurement" style="display: none;">
      <div class="csv-table-placeholder">Loading Proc Guidelines...</div>
    </div>
    <div class="csv-tab-container" id="tab-Food" style="display: none;">
      <div class="csv-table-placeholder">Loading Food Policy...</div>
    </div>
    <div class="csv-tab-container" id="tab-Misc" style="display: none;">
      <div class="csv-table-placeholder">Loading Miscellaneous...</div>
    </div>
    
    <!-- GOVT. CALENDARS TAB - Loads from GitHub -->
    <div class="csv-tab-container" id="tab-Govt Calendars" style="display: none;">
      <div class="csv-table-placeholder">Loading Govt. Calendars...</div>
    </div>
  </div>

</div>

<!-- FOOTER -->
<div id="site-footer"></div>

<script>
  (function() {
    "use strict";

    // ------- CONFIGURATION --------
    const CSV_URL = "https://docs.google.com/spreadsheets/d/1mLh8E5JEHP-HCrBgs42pVpiY4ZpP7LG-O__3Av2-MgY/export?format=csv&gid=884226509";
    const GOVT_CALENDARS_URL = "https://raw.githubusercontent.com/saratoffice/office/main/calendars.html";
    
    let parsedRows = [];

    // ---------- LOAD CSV DATA ----------
    function loadAllCSVTables() {
      fetch(CSV_URL)
        .then(response => response.text())
        .then(csvText => {
          const parsed = Papa.parse(csvText, { header: false });
          const rows = parsed.data.slice(1);
          parsedRows = rows.filter(row => row && row.length > 1);

          populateTableForCategory('Act');
          populateTableForCategory('Rules');
          populateTableForCategory('Order');
          populateTableForCategory('MSP');
          populateTableForCategory('Procurement');
          populateTableForCategory('Food');
          populateTableForCategory('Misc');
        })
        .catch(err => {
          console.error("CSV Load Error:", err);
        });
    }

    // ---------- BUILD CSV TABLE HTML ----------
    function buildTableHTML(category) {
      const filtered = parsedRows.filter(row => row[1] && row[1].trim() === category);
      if (filtered.length === 0) {
        return `<table class="csv-table"><thead><tr><th>S.No.</th><th>Subject</th><th>Download</th><th>Share</th></tr></thead><tbody><tr><td colspan="4" style="text-align:center; padding:40px;">üìÅ No documents for ${category}</td></tr></tbody></table>`;
      }

      const rowsHtml = filtered.map((row, idx) => {
        let subject = (row[2] || "").replace(/_/g, " ").replace(/\.pdf$/i, "").trim() || "Untitled";
        const link = row[5] ? row[5].trim() : "#";
        const safeLink = (link.startsWith("http") || link.startsWith("/")) ? link : "#";
        const encodedSubject = encodeURIComponent("üìÑ " + subject + "\nüîó " + safeLink);
        return `<tr>
          <td>${idx + 1}</td>
          <td>${subject}</td>
          <td><a href="${safeLink}" target="_blank"><button class="download-btn">Download</button></a></td>
          <td><a href="https://wa.me/?text=${encodedSubject}" target="_blank"><button class="share-btn">Share</button></a></td>
        </tr>`;
      }).join("");

      return `<table class="csv-table">
        <thead><tr><th>S.No.</th><th>Subject</th><th>Download</th><th>Share</th></tr></thead>
        <tbody>${rowsHtml}</tbody>
      </table>`;
    }

    function populateTableForCategory(category) {
      const tabDiv = document.getElementById(`tab-${category}`);
      if (!tabDiv) return;
      const placeholder = tabDiv.querySelector('.csv-table-placeholder');
      if (!placeholder) return;
      if (parsedRows.length === 0) {
        placeholder.innerHTML = '‚è≥ Loading...';
        return;
      }
      placeholder.innerHTML = buildTableHTML(category);
    }

    // ---------- LOAD GOVT. CALENDARS FROM GITHUB ----------
    function loadGovtCalendars() {
      const calendarContainer = document.getElementById('tab-Govt Calendars');
      if (!calendarContainer) return;
      
      const placeholder = calendarContainer.querySelector('.csv-table-placeholder');
      if (!placeholder) return;
      
      placeholder.innerHTML = '<div style="text-align: center; padding: 40px;">üìÖ Loading Government Calendars...</div>';
      
      fetch(GOVT_CALENDARS_URL)
        .then(response => {
          if (!response.ok) throw new Error('Network response was not ok');
          return response.text();
        })
        .then(html => {
          // Extract the content inside the govt-calendars-section div
          const parser = new DOMParser();
          const doc = parser.parseFromString(html, 'text/html');
          const calendarSection = doc.querySelector('.govt-calendars-section');
          
          if (calendarSection) {
            placeholder.innerHTML = calendarSection.outerHTML;
          } else {
            // Fallback: insert the entire HTML
            placeholder.innerHTML = html;
          }
        })
        .catch(error => {
          console.error('Error loading Govt. Calendars:', error);
          placeholder.innerHTML = `
            <div style="text-align: center; padding: 50px; background: white; border-radius: 12px; box-shadow: 0 8px 20px rgba(0,0,0,0.1);">
              <h2 style="color: #0083ed; font-size: 28pt; margin-bottom: 20px;">GOVT. CALENDARS</h2>
              <p style="color: #666; font-size: 18px;">‚ö†Ô∏è Unable to load calendars. Please try again later.</p>
              <p style="color: #999; margin-top: 20px;">Error: ${error.message}</p>
            </div>
          `;
        });
    }

    // ---------- TAB CLICK HANDLER ----------
    function initTabs() {
      const tabStrip = document.querySelector('.sarat-docs .tab-strip');
      if (!tabStrip) return;
      const tabButtons = tabStrip.querySelectorAll('.tab-item');
      
      const containers = {
        Act: document.getElementById('tab-Act'),
        Rules: document.getElementById('tab-Rules'),
        Order: document.getElementById('tab-Order'),
        MSP: document.getElementById('tab-MSP'),
        Procurement: document.getElementById('tab-Procurement'),
        Food: document.getElementById('tab-Food'),
        Misc: document.getElementById('tab-Misc'),
        'Govt Calendars': document.getElementById('tab-Govt Calendars')
      };

      function activateTab(category) {
        // Update active class
        tabButtons.forEach(btn => {
          const btnCat = btn.getAttribute('data-category');
          btn.classList.toggle('active', btnCat === category);
        });

        // Show/hide containers
        Object.keys(containers).forEach(key => {
          if (containers[key]) {
            containers[key].style.display = key === category ? 'block' : 'none';
          }
        });

        // Load data if needed
        if (parsedRows.length > 0) {
          const target = containers[category];
          if (target && category !== 'Govt Calendars') {
            const placeholder = target.querySelector('.csv-table-placeholder');
            if (placeholder && placeholder.innerHTML.includes('Loading')) {
              placeholder.innerHTML = buildTableHTML(category);
            }
          }
        }
        
        // Special handling for Govt. Calendars
        if (category === 'Govt Calendars') {
          loadGovtCalendars();
        }
      }

      tabButtons.forEach(btn => {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          const category = this.getAttribute('data-category');
          activateTab(category);
        });
      });

      // Initial active tab
      activateTab('Act');
    }

</script>
<script src="/assets/Scripts/gototop.js"></script></body>
</html>
