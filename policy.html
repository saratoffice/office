<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sarat Office ¬∑ ACTS Horizontal Tabs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Common CSS -->
    <link rel="stylesheet" href="style.css">
      <!-- Papaparse for CSV parsing -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <style>
    /* ---------- RESET / GLOBAL ---------- */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #f5f9ff;
      font-family: 'Segoe UI', Roboto, system-ui, sans-serif;
      line-height: 1.5;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px 30px;
    }

    /* ----- HORIZONTAL TAB STRIP ‚Äì exactly like image + 3D active/inactive hover ----- */
    .tab-strip {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 8px;
      background: #eef5fc;           /* soft cloud base */
      padding: 18px 24px;
      border-radius: 60px;
      margin: 30px 0 20px 0;
      box-shadow: 
        inset 0 -2px 0 rgba(0,0,0,0.02),
        0 10px 20px -8px rgba(0,80,120,0.2);
      border: 1px solid rgba(255,255,255,0.6);
      backdrop-filter: blur(2px);
    }

    /* tab pill ‚Äî 3D default (inactive) */
    .tab-item {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 12px 28px;
      font-size: 1rem;
      font-weight: 600;
      letter-spacing: 0.4px;
      color: #1a2b4c;
      background: linear-gradient(145deg, #ffffff, #f0f6fd);
      border: none;
      border-radius: 50px;
      box-shadow: 
        inset 0 -3px 0 rgba(0,0,0,0.05),
        0 6px 10px rgba(0,35,70,0.08),
        0 2px 4px rgba(0,20,50,0.04);
      transition: all 0.2s ease-in-out;
      cursor: pointer;
      text-decoration: none;
      border: 1px solid rgba(255,255,255,0.7);
    }

    /* hover ‚Äì slight lift, deep glow */
    .tab-item:hover {
      background: linear-gradient(145deg, #ffffff, #e6f0ff);
      transform: translateY(-2px);
      box-shadow: 
        inset 0 -2px 0 rgba(0,120,210,0.1),
        0 12px 18px -6px #0088cc55,
        0 4px 8px rgba(0,85,170,0.15);
      color: #003e7e;
    }

    /* ACTIVE tab ‚Äì pressed, prominent blue gradient, white text, extra depth */
    .tab-item.active {
      background: linear-gradient(145deg, #004b8f, #002856);
      color: white !important;
      box-shadow: 
        inset 0 -3px 0 rgba(0,0,0,0.2),
        inset 0 2px 8px rgba(255,255,255,0.2),
        0 10px 18px -4px #00224499,
        0 4px 6px rgba(0,50,80,0.3);
      border: 1px solid #aac9ff;
      text-shadow: 0 1px 2px black;
      transform: scale(1.02);
    }

    /* active hover ‚Äì stays deep */
    .tab-item.active:hover {
      background: linear-gradient(145deg, #003f7a, #001e3c);
      box-shadow: 
        inset 0 -3px 0 #00000030,
        0 16px 22px -6px #001c3c;
      transform: translateY(-1px);
    }

    /* mimic the 'ACTS ¬∑ RULES ¬∑ ORDERS ...' from image, plus extra categories */
    .tab-strip .spacer {
      width: 4px;
      height: 30px;
      background: rgba(0,70,130,0.1);
      border-radius: 4px;
      margin: 0 6px;
    }

    /* optional subtle dividers ‚Äì like image feel */
    .tab-divider {
      color: #6a8fb1;
      font-weight: 300;
      font-size: 24px;
      margin: 0 4px;
      opacity: 0.4;
      user-select: none;
    }

    /* ----- 3D table with glaze (your EXISTING preserved + enhanced) ----- */
    .csv-tab-container {
      overflow-x: auto;
      padding: 12px 0 30px 0;
      background: transparent;
      margin-top: 6px;
    }

    .csv-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      font-family: 'Segoe UI', sans-serif;
      font-size: 15px;
      min-width: 700px;
      border-radius: 16px;
      overflow: hidden;
      background: #ffffff;
      box-shadow:
        0 0 0 4px #e0f0ff,
        0 6px 16px rgba(0, 102, 204, 0.15),
        inset 0 0 8px rgba(0, 174, 255, 0.08);
      transition: box-shadow 0.2s;
    }

    .csv-table thead {
      background: linear-gradient(90deg, #101535, #1c295f);
    }

    .csv-table thead th {
      color: #fff !important;
      font-weight: 600;
      text-align: center;
      padding: 18px 15px;
      letter-spacing: 0.6px;
      font-size: 16px;
    }

    .csv-table td {
      padding: 16px 15px;
      border-bottom: 1px solid #d9e9ff;
      vertical-align: middle;
      background-color: rgba(255, 255, 255, 0.9);
    }

    .csv-table td:nth-child(3),
    .csv-table td:nth-child(4) {
      text-align: center;
    }

    .csv-table tbody tr:hover {
      background-color: #fffbee;
      transition: background-color 0.2s;
      box-shadow: inset 0 0 12px rgba(0,123,255,0.1);
    }

    /* --- 3D buttons ‚Äì extra bounce, preserved with love --- */
    .download-btn,
    .share-btn {
      min-width: 110px;
      padding: 10px 18px;
      font-size: 14px;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      color: white;
      text-shadow: 0 1px 2px rgba(0,0,0,0.2);
      box-shadow:
        inset 0 -2px 0 rgba(0,0,0,0.2),
        0 4px 10px rgba(0,0,0,0.15),
        0 6px 20px rgba(0, 102, 204, 0.1);
      transform: translateY(0);
      transition: all 0.3s ease-in-out;
    }

    .download-btn {
      background: linear-gradient(145deg, #4caf50, #2e7d32);
    }

    .download-btn:hover {
      background: linear-gradient(145deg, #2e7d32, #1b5e20);
      transform: translateY(-2px);
      box-shadow:
        inset 0 -2px 0 rgba(0,0,0,0.25),
        0 8px 20px rgba(67, 160, 71, 0.4);
    }

    .share-btn {
      background: linear-gradient(145deg, #007bff, #0056b3);
    }

    .share-btn:hover {
      background: linear-gradient(145deg, #0056b3, #003f88);
      transform: translateY(-2px);
      box-shadow:
        inset 0 -2px 0 rgba(0,0,0,0.25),
        0 8px 20px rgba(0, 123, 255, 0.4);
    }

    /* section title ‚Äì keep your 32pt look */
    .section-title {
      text-align: center;
      font-size: 32pt;
      color: #0083ed;
      font-weight: 700;
      letter-spacing: 1px;
      margin: 10px 0 5px 0;
      text-shadow: 0 2px 6px rgba(0,131,237,0.2);
    }

    /* header & footer simulation (unchanged) */
    #site-header, #site-footer {
      background: #0a1a2b;
      color: white;
      padding: 16px 32px;
    }

    /* mobile friendly tab wrap */
    @media (max-width: 800px) {
      .tab-item {
        padding: 10px 18px;
        font-size: 0.9rem;
      }
      .section-title { font-size: 28pt; }
    }

    /* dummy nav/footer styling ‚Äì matches your includes */
    .dummy-nav, .dummy-footer {
      background: #0f1f30;
      color: #cfe2ff;
      padding: 18px 30px;
      font-size: 1.1rem;
    }
  </style>
</head>
<body>

<!-- HEADER placeholder (as in original) -->
<div id="site-header"></div>

<!-- MAIN CONTENT with HORIZONTAL TABS (exactly like image + active/inactive 3D) -->
<div class="container">

  <!-- ===== HORIZONTAL TAB STRIP ‚Äì ACTS, RULES, ORDERS, PADDY MSP, PROC GUIDELINES, FOOD POLICY, MISCELLANEOUS, GOVT. CALENDARS ===== -->
  <div class="tab-strip" id="horizontalTabStrip">
    <!-- ACTS tab ‚Äì active by default -->
    <button class="tab-item active" data-category="Act">ACTS</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Rules">RULES</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Order">ORDERS</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Paddy MSP">PADDY MSP</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Proc Guidelines">PROC GUIDELINES</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Food Policy">FOOD POLICY</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Miscellaneous">MISCELLANEOUS</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Govt Calendars">GOVT. CALENDARS</button>
  </div>

  <!-- ===== DYNAMIC TABLE AREA (ACTS visible by default) ===== -->
  <div id="dynamicTableArea">
    <!-- Acts container ‚Äì will be populated, others are hidden until tab click -->
    <div class="csv-tab-container" id="tab-Act" style="display: block;">
      <div class="csv-table-placeholder">Loading Acts...</div>
    </div>
    <div class="csv-tab-container" id="tab-Rules" style="display: none;">
      <div class="csv-table-placeholder">Loading Rules...</div>
    </div>
    <div class="csv-tab-container" id="tab-Order" style="display: none;">
      <div class="csv-table-placeholder">Loading Orders...</div>
    </div>
    <div class="csv-tab-container" id="tab-Paddy MSP" style="display: none;">
      <div class="csv-table-placeholder">Loading Paddy MSP...</div>
    </div>
    <div class="csv-tab-container" id="tab-Proc Guidelines" style="display: none;">
      <div class="csv-table-placeholder">Loading Proc Guidelines...</div>
    </div>
    <div class="csv-tab-container" id="tab-Food Policy" style="display: none;">
      <div class="csv-table-placeholder">Loading Food Policy...</div>
    </div>
    <div class="csv-tab-container" id="tab-Miscellaneous" style="display: none;">
      <div class="csv-table-placeholder">Loading Miscellaneous...</div>
    </div>
    <div class="csv-tab-container" id="tab-Govt Calendars" style="display: none;">
      <div class="csv-table-placeholder">Loading Govt. Calendars...</div>
    </div>
  </div>

  <!-- subtle extra space ‚Äì footer will appear -->
</div>

<!-- FOOTER placeholder -->
<div id="site-footer"></div>

<script>
  (function() {
    "use strict";

    // ------- CSV FETCH & GLOBAL DATA STORAGE -------
    const CSV_URL = "https://docs.google.com/spreadsheets/d/1mLh8E5JEHP-HCrBgs42pVpiY4ZpP7LG-O__3Av2-MgY/export?format=csv&gid=884226509";
    let parsedRows = []; // store all rows after fetch

    // category mapping: from data-category attribute (tab button) to CSV column 1 (category)
    // we also want to display exactly the category name as per button.
    // we keep both the same.

    // ---------- FETCH AND POPULATE ALL TABLES ----------
    function loadAllCSVTables() {
      fetch(CSV_URL)
        .then(response => response.text())
        .then(csvText => {
          const parsed = Papa.parse(csvText, { header: false });
          const rows = parsed.data.slice(1); // skip header row
          parsedRows = rows.filter(row => row && row.length > 1); // keep valid

          // Populate each tab container
          populateTableForCategory('Act');
          populateTableForCategory('Rules');
          populateTableForCategory('Order');
          populateTableForCategory('Paddy MSP');
          populateTableForCategory('Proc Guidelines');
          populateTableForCategory('Food Policy');
          populateTableForCategory('Miscellaneous');
          populateTableForCategory('Govt Calendars');
        })
        .catch(err => {
          console.error("CSV Load Error:", err);
          document.querySelectorAll('.csv-table-placeholder').forEach(el => {
            el.innerHTML = `<span style="color: red;">‚ö†Ô∏è Failed to load data. Check console.</span>`;
          });
        });
    }

    // helper: build table HTML for given category
    function buildTableHTML(category) {
      const filtered = parsedRows.filter(row => row[1] && row[1].trim() === category);
      // If no rows, show empty state
      if (filtered.length === 0) {
        return `<table class="csv-table"><thead><tr><th>S.No.</th><th>Subject</th><th>Download</th><th>Share</th></tr></thead><tbody><tr><td colspan="4" style="text-align:center; padding:40px;">üìÅ No documents available for ${category}</td></tr></tbody></table>`;
      }

      const rowsHtml = filtered.map((row, idx) => {
        let subject = (row[2] || "").replace(/_/g, " ").replace(/\.pdf$/i, "").trim();
        if (subject === "") subject = "Untitled Document";
        const link = row[5] ? row[5].trim() : "#";
        // ensure link is absolute or relative; if not, provide fallback
        const safeLink = (link.startsWith("http") || link.startsWith("/")) ? link : "#";
        const encodedSubject = encodeURIComponent("üìÑ " + subject + "\nüîó " + safeLink);
        return `<tr>
          <td>${idx + 1}</td>
          <td>${subject}</td>
          <td><a href="${safeLink}" target="_blank"><button class="download-btn">Download</button></a></td>
          <td><a href="https://wa.me/?text=${encodedSubject}" target="_blank"><button class="share-btn">Share</button></a></td>
        </tr>`;
      }).join("");

      return `<table class="csv-table">
        <thead><tr><th>S.No.</th><th>Subject</th><th>Download</th><th>Share</th></tr></thead>
        <tbody>${rowsHtml}</tbody>
      </table>`;
    }

    function populateTableForCategory(category) {
      const tabDiv = document.getElementById(`tab-${category}`);
      if (!tabDiv) return;
      const placeholder = tabDiv.querySelector('.csv-table-placeholder');
      if (!placeholder) return;
      if (parsedRows.length === 0) {
        placeholder.innerHTML = '‚è≥ Loading...';
        return;
      }
      const tableHTML = buildTableHTML(category);
      placeholder.innerHTML = tableHTML;
    }

    // ---------- TAB CLICK HANDLER (horizontal 3D active/inactive effect) ----------
    function initTabs() {
      const tabStrip = document.getElementById('horizontalTabStrip');
      const tabButtons = tabStrip.querySelectorAll('.tab-item');
      const containers = {
        Act: document.getElementById('tab-Act'),
        Rules: document.getElementById('tab-Rules'),
        Order: document.getElementById('tab-Order'),
        'Paddy MSP': document.getElementById('tab-Paddy MSP'),
        'Proc Guidelines': document.getElementById('tab-Proc Guidelines'),
        'Food Policy': document.getElementById('tab-Food Policy'),
        Miscellaneous: document.getElementById('tab-Miscellaneous'),
        'Govt Calendars': document.getElementById('tab-Govt Calendars')
      };

      function activateTab(category) {
        // 1. update button active class
        tabButtons.forEach(btn => {
          const btnCat = btn.getAttribute('data-category');
          if (btnCat === category) {
            btn.classList.add('active');
          } else {
            btn.classList.remove('active');
          }
        });

        // 2. hide all containers, show selected
        Object.keys(containers).forEach(key => {
          if (containers[key]) {
            containers[key].style.display = key === category ? 'block' : 'none';
          }
        });

        // 3. if table content not yet built or empty (fallback), but we already pre-populated all. However, ensure populate if missing
        if (parsedRows.length > 0) {
          const targetContainer = containers[category];
          if (targetContainer) {
            const placeholder = targetContainer.querySelector('.csv-table-placeholder');
            // if placeholder still has loading text, rebuild
            if (placeholder && placeholder.innerText.includes('Loading')) {
              placeholder.innerHTML = buildTableHTML(category);
            }
          }
        }
      }

      // attach click listeners
      tabButtons.forEach(btn => {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          const category = this.getAttribute('data-category');
          activateTab(category);
        });
      });

      // initial active: ACTS (already set in HTML, but ensure container visible)
      activateTab('Act');
    }

    // ----- LOAD HEADER, FOOTER, then init CSV and tabs (keep original fetch pattern)-----
    function loadHeaderFooter() {
      // Simulate loading header.html and footer.html ‚Äì using dummy content to avoid 404.
      // but we keep exactly same as original: fetch header.html, footer.html, nav.html
      // If files missing, we provide fallback to prevent empty areas.
      const headerEl = document.getElementById('site-header');
      const footerEl = document.getElementById('site-footer');

      // Provide dummy gradient bar matching original style (since actual files may not exist)
      // But we preserve the fetch attempts. In case of error, we set visible placeholder.
      Promise.all([
        fetch('header.html').catch(() => ({ ok: false })),
        fetch('footer.html').catch(() => ({ ok: false }))
      ]).then(responses => {
        // HEADER
        if (responses[0] && responses[0].ok) {
          responses[0].text().then(html => headerEl.innerHTML = html);
        } else {
          headerEl.innerHTML = `<div style="background: #0c1f33; color: white; padding: 18px 30px; font-size: 24px; font-weight: bold;">üìò SARAT OFFICE</div>`;
        }
        // FOOTER
        if (responses[1] && responses[1].ok) {
          responses[1].text().then(html => footerEl.innerHTML = html);
        } else {
          footerEl.innerHTML = `<div style="background: #0a1929; color: #bbd6ff; padding: 20px 30px; text-align: center;">¬© Sarat Government Office ‚Äî eDocuments</div>`;
        }
      });

      // also nav.html? original script loads nav inside header, we skip for brevity but keep mobile logic.
      // we call the original mobile menu listener (copy from original)
    }

    // ----- START -----
    loadHeaderFooter();
    loadAllCSVTables();   // async fetch + populate all tabs
    initTabs();           // set up click behavior, active = Acts

    // preserve the original mobile dropdown logic (from original)
    document.addEventListener("click", function (e) {
      /* Toggle main menu ‚Äì if .menu-toggle exists in header after load */
      if (e.target.classList.contains("menu-toggle")) {
        const menu = document.querySelector(".menu");
        if (menu) menu.classList.toggle("open");
      }
      const dropdownLink = e.target.closest(".dropdown > a");
      if (dropdownLink && window.innerWidth <= 900) {
        e.preventDefault();
        dropdownLink.parentElement.classList.toggle("open");
      }
    });

  })();
</script>

<!-- ensure that after CSV load, any visible tab gets fresh table (Act is visible) -->
<script>
  // additional safety: after window load, if parsedRows populated, refresh current active tab
  window.addEventListener('load', function() {
    setTimeout(() => {
      if (window.parsedRows && window.parsedRows.length > 0) {
        const activeTab = document.querySelector('.tab-item.active');
        if (activeTab) {
          const cat = activeTab.getAttribute('data-category');
          const container = document.getElementById(`tab-${cat}`);
          if (container) {
            const placeholder = container.querySelector('.csv-table-placeholder');
            if (placeholder && !placeholder.innerHTML.includes('csv-table')) {
              placeholder.innerHTML = buildTableHTML(cat);
            }
          }
        }
      }
    }, 100);
  });
</script>

</body>
</html>
