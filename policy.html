<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sarat Office ¬∑ Isolated Tabs (Header/Footer safe)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Papaparse for CSV parsing -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<!-- Common CSS -->
    <link rel="stylesheet" href="style.css">
      <style>
    /* ----- GLOBAL RESET (non‚Äëinvasive) ----- */
    body {
      margin: 0;
      background: #f5f9ff;
      font-family: 'Segoe UI', Roboto, sans-serif;
    }

    /* ----- NAMESPACED WRAPPER ‚Äì all custom CSS is scoped inside .sarat-docs ----- */
    .sarat-docs {
      display: block;
      width: 100%;
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px 30px;
      box-sizing: border-box;
    }

    /* ---- HORIZONTAL TABS ‚Äì 3D pill style (completely isolated) ---- */
    .sarat-docs .tab-strip {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 8px;
      background: #eef5fc;
      padding: 18px 24px;
      border-radius: 60px;
      margin: 30px 0 20px 0;
      box-shadow: 
        inset 0 -2px 0 rgba(0,0,0,0.02),
        0 10px 20px -8px rgba(0,80,120,0.2);
      border: 1px solid rgba(255,255,255,0.6);
      backdrop-filter: blur(2px);
    }

    .sarat-docs .tab-item {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 12px 28px;
      font-size: 1rem;
      font-weight: 600;
      letter-spacing: 0.4px;
      color: #1a2b4c;
      background: linear-gradient(145deg, #ffffff, #f0f6fd);
      border: none;
      border-radius: 50px;
      box-shadow: 
        inset 0 -3px 0 rgba(0,0,0,0.05),
        0 6px 10px rgba(0,35,70,0.08),
        0 2px 4px rgba(0,20,50,0.04);
      transition: all 0.2s ease-in-out;
      cursor: pointer;
      text-decoration: none;
      border: 1px solid rgba(255,255,255,0.7);
    }

    .sarat-docs .tab-item:hover {
      background: linear-gradient(145deg, #ffffff, #e6f0ff);
      transform: translateY(-2px);
      box-shadow: 
        inset 0 -2px 0 rgba(0,120,210,0.1),
        0 12px 18px -6px #0088cc55,
        0 4px 8px rgba(0,85,170,0.15);
      color: #003e7e;
    }

    .sarat-docs .tab-item.active {
      background: linear-gradient(145deg, #004b8f, #002856);
      color: white !important;
      box-shadow: 
        inset 0 -3px 0 rgba(0,0,0,0.2),
        inset 0 2px 8px rgba(255,255,255,0.2),
        0 10px 18px -4px #00224499,
        0 4px 6px rgba(0,50,80,0.3);
      border: 1px solid #aac9ff;
      text-shadow: 0 1px 2px black;
      transform: scale(1.02);
    }

    .sarat-docs .tab-item.active:hover {
      background: linear-gradient(145deg, #003f7a, #001e3c);
      box-shadow: 
        inset 0 -3px 0 #00000030,
        0 16px 22px -6px #001c3c;
      transform: translateY(-1px);
    }

    .sarat-docs .tab-divider {
      color: #6a8fb1;
      font-weight: 300;
      font-size: 24px;
      margin: 0 4px;
      opacity: 0.4;
      user-select: none;
    }

    /* ----- 3D table with glaze (namespaced) ----- */
    .sarat-docs .csv-tab-container {
      overflow-x: auto;
      padding: 12px 0 30px 0;
      background: transparent;
      margin-top: 6px;
    }

    .sarat-docs .csv-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      font-family: 'Segoe UI', sans-serif;
      font-size: 15px;
      min-width: 700px;
      border-radius: 16px;
      overflow: hidden;
      background: #ffffff;
      box-shadow:
        0 0 0 4px #e0f0ff,
        0 6px 16px rgba(0, 102, 204, 0.15),
        inset 0 0 8px rgba(0, 174, 255, 0.08);
      transition: box-shadow 0.2s;
    }

    .sarat-docs .csv-table thead {
      background: linear-gradient(90deg, #101535, #1c295f);
    }

    .sarat-docs .csv-table thead th {
      color: #fff !important;
      font-weight: 600;
      text-align: center;
      padding: 18px 15px;
      letter-spacing: 0.6px;
      font-size: 16px;
    }

    .sarat-docs .csv-table td {
      padding: 16px 15px;
      border-bottom: 1px solid #d9e9ff;
      vertical-align: middle;
      background-color: rgba(255, 255, 255, 0.9);
    }

    .sarat-docs .csv-table td:nth-child(3),
    .sarat-docs .csv-table td:nth-child(4) {
      text-align: center;
    }

    .sarat-docs .csv-table tbody tr:hover {
      background-color: #fffbee;
      transition: background-color 0.2s;
      box-shadow: inset 0 0 12px rgba(0,123,255,0.1);
    }

    .sarat-docs .download-btn,
    .sarat-docs .share-btn {
      min-width: 110px;
      padding: 10px 18px;
      font-size: 14px;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      color: white;
      text-shadow: 0 1px 2px rgba(0,0,0,0.2);
      box-shadow:
        inset 0 -2px 0 rgba(0,0,0,0.2),
        0 4px 10px rgba(0,0,0,0.15),
        0 6px 20px rgba(0, 102, 204, 0.1);
      transform: translateY(0);
      transition: all 0.3s ease-in-out;
    }

    .sarat-docs .download-btn {
      background: linear-gradient(145deg, #4caf50, #2e7d32);
    }

    .sarat-docs .download-btn:hover {
      background: linear-gradient(145deg, #2e7d32, #1b5e20);
      transform: translateY(-2px);
      box-shadow:
        inset 0 -2px 0 rgba(0,0,0,0.25),
        0 8px 20px rgba(67, 160, 71, 0.4);
    }

    .sarat-docs .share-btn {
      background: linear-gradient(145deg, #007bff, #0056b3);
    }

    .sarat-docs .share-btn:hover {
      background: linear-gradient(145deg, #0056b3, #003f88);
      transform: translateY(-2px);
      box-shadow:
        inset 0 -2px 0 rgba(0,0,0,0.25),
        0 8px 20px rgba(0, 123, 255, 0.4);
    }

    @media (max-width: 800px) {
      .sarat-docs .tab-item {
        padding: 10px 18px;
        font-size: 0.9rem;
      }
    }

    /* fallback header/footer (only if fetch fails) */
    .fallback-header {
      background: #0c1f33;
      color: white;
      padding: 18px 30px;
      font-size: 24px;
      font-weight: bold;
    }
    .fallback-footer {
      background: #0a1929;
      color: #bbd6ff;
      padding: 20px 30px;
      text-align: center;
    }
  </style>
</head>
<body>

<!-- ===== YOUR HEADER ‚Äì completely untouched ===== -->
<div id="site-header"></div>

<!-- ===== MAIN DOCS COMPONENT ‚Äì everything inside .sarat-docs ===== -->
<div class="sarat-docs">

  <!-- Horizontal tab strip ‚Äì categories exactly as per image + your list -->
  <div class="tab-strip" id="horizontalTabStrip">
    <button class="tab-item active" data-category="Act">ACTS</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Rules">RULES</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Order">ORDERS</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="MSP">PADDY MSP</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Procurement">PROC GUIDELINES</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Food">FOOD POLICY</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Misc">MISCELLANEOUS</button>
    <span class="tab-divider">‚Ä¢</span>
    <button class="tab-item" data-category="Govt Calendars">GOVT. CALENDARS</button>
  </div>

  <!-- Dynamic table area ‚Äì each container ID matches the updated category names -->
  <div id="dynamicTableArea">
    <div class="csv-tab-container" id="tab-Act" style="display: block;">
      <div class="csv-table-placeholder">Loading Acts...</div>
    </div>
    <div class="csv-tab-container" id="tab-Rules" style="display: none;">
      <div class="csv-table-placeholder">Loading Rules...</div>
    </div>
    <div class="csv-tab-container" id="tab-Order" style="display: none;">
      <div class="csv-table-placeholder">Loading Orders...</div>
    </div>
    <div class="csv-tab-container" id="tab-MSP" style="display: none;">
      <div class="csv-table-placeholder">Loading Paddy MSP...</div>
    </div>
    <div class="csv-tab-container" id="tab-Procurement" style="display: none;">
      <div class="csv-table-placeholder">Loading Proc Guidelines...</div>
    </div>
    <div class="csv-tab-container" id="tab-Food" style="display: none;">
      <div class="csv-table-placeholder">Loading Food Policy...</div>
    </div>
    <div class="csv-tab-container" id="tab-Misc" style="display: none;">
      <div class="csv-table-placeholder">Loading Miscellaneous...</div>
    </div>
    <div class="csv-tab-container" id="tab-Govt Calendars" style="display: none;">
      <div class="csv-table-placeholder">Loading Govt. Calendars...</div>
    </div>
  </div>

</div> <!-- end .sarat-docs -->

<!-- ===== YOUR FOOTER ‚Äì completely untouched ===== -->
<div id="site-footer"></div>

<script>
  (function() {
    "use strict";

    // ------- CSV FETCH -------
    const CSV_URL = "https://docs.google.com/spreadsheets/d/1mLh8E5JEHP-HCrBgs42pVpiY4ZpP7LG-O__3Av2-MgY/export?format=csv&gid=884226509";
    let parsedRows = [];

    // ---------- FETCH AND POPULATE ALL TABLES (UPDATED CATEGORY NAMES) ----------
    function loadAllCSVTables() {
      fetch(CSV_URL)
        .then(response => response.text())
        .then(csvText => {
          const parsed = Papa.parse(csvText, { header: false });
          const rows = parsed.data.slice(1); // skip header row
          parsedRows = rows.filter(row => row && row.length > 1);

          /* --- REPLACED CATEGORIES --- */
          populateTableForCategory('Act');
          populateTableForCategory('Rules');
          populateTableForCategory('Order');
          populateTableForCategory('MSP');           // was 'Paddy MSP'
          populateTableForCategory('Procurement');   // was 'Proc Guidelines'
          populateTableForCategory('Food');          // was 'Food Policy'
          populateTableForCategory('Misc');          // was 'Miscellaneous'
          populateTableForCategory('Govt Calendars');
        })
        .catch(err => {
          console.error("CSV Load Error:", err);
          document.querySelectorAll('.sarat-docs .csv-table-placeholder').forEach(el => {
            el.innerHTML = `<span style="color: red;">‚ö†Ô∏è Failed to load data.</span>`;
          });
        });
    }

    // build table HTML for a given category
    function buildTableHTML(category) {
      const filtered = parsedRows.filter(row => row[1] && row[1].trim() === category);
      if (filtered.length === 0) {
        return `<table class="csv-table"><thead><tr><th>S.No.</th><th>Subject</th><th>Download</th><th>Share</th></tr></thead><tbody><tr><td colspan="4" style="text-align:center; padding:40px;">üìÅ No documents for ${category}</td></tr></tbody></table>`;
      }

      const rowsHtml = filtered.map((row, idx) => {
        let subject = (row[2] || "").replace(/_/g, " ").replace(/\.pdf$/i, "").trim();
        if (subject === "") subject = "Untitled";
        const link = row[5] ? row[5].trim() : "#";
        const safeLink = (link.startsWith("http") || link.startsWith("/")) ? link : "#";
        const encodedSubject = encodeURIComponent("üìÑ " + subject + "\nüîó " + safeLink);
        return `<tr>
          <td>${idx + 1}</td>
          <td>${subject}</td>
          <td><a href="${safeLink}" target="_blank"><button class="download-btn">Download</button></a></td>
          <td><a href="https://wa.me/?text=${encodedSubject}" target="_blank"><button class="share-btn">Share</button></a></td>
        </tr>`;
      }).join("");

      return `<table class="csv-table">
        <thead><tr><th>S.No.</th><th>Subject</th><th>Download</th><th>Share</th></tr></thead>
        <tbody>${rowsHtml}</tbody>
      </table>`;
    }

    function populateTableForCategory(category) {
      const tabDiv = document.getElementById(`tab-${category}`);
      if (!tabDiv) {
        console.warn(`Container for category "${category}" not found.`);
        return;
      }
      const placeholder = tabDiv.querySelector('.csv-table-placeholder');
      if (!placeholder) return;
      if (parsedRows.length === 0) {
        placeholder.innerHTML = '‚è≥ Loading...';
        return;
      }
      placeholder.innerHTML = buildTableHTML(category);
    }

    // ---------- TAB CLICK HANDLER (updated container IDs) ----------
    function initTabs() {
      const tabStrip = document.querySelector('.sarat-docs .tab-strip');
      if (!tabStrip) return;
      const tabButtons = tabStrip.querySelectorAll('.tab-item');
      
      const containers = {
        Act: document.getElementById('tab-Act'),
        Rules: document.getElementById('tab-Rules'),
        Order: document.getElementById('tab-Order'),
        MSP: document.getElementById('tab-MSP'),
        Procurement: document.getElementById('tab-Procurement'),
        Food: document.getElementById('tab-Food'),
        Misc: document.getElementById('tab-Misc'),
        'Govt Calendars': document.getElementById('tab-Govt Calendars')
      };

      function activateTab(category) {
        // update active class on buttons
        tabButtons.forEach(btn => {
          const btnCat = btn.getAttribute('data-category');
          btn.classList.toggle('active', btnCat === category);
        });

        // show/hide containers
        Object.keys(containers).forEach(key => {
          if (containers[key]) {
            containers[key].style.display = key === category ? 'block' : 'none';
          }
        });

        // ensure table is built if needed
        if (parsedRows.length > 0) {
          const target = containers[category];
          if (target) {
            const placeholder = target.querySelector('.csv-table-placeholder');
            if (placeholder && placeholder.innerHTML.includes('Loading')) {
              placeholder.innerHTML = buildTableHTML(category);
            }
          }
        }
      }

      tabButtons.forEach(btn => {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          const category = this.getAttribute('data-category');
          activateTab(category);
        });
      });

      // initial active = Act
      activateTab('Act');
    }

    // ----- HEADER / FOOTER LOADER (unchanged, safe) -----
    function loadHeaderFooter() {
      const headerEl = document.getElementById('site-header');
      const footerEl = document.getElementById('site-footer');

      Promise.all([
        fetch('header.html').catch(() => ({ ok: false })),
        fetch('footer.html').catch(() => ({ ok: false }))
      ]).then(responses => {
        if (responses[0] && responses[0].ok) {
          responses[0].text().then(html => { headerEl.innerHTML = html; });
        } else {
          headerEl.innerHTML = '<div class="fallback-header">üìò SARAT OFFICE</div>';
        }

        if (responses[1] && responses[1].ok) {
          responses[1].text().then(html => { footerEl.innerHTML = html; });
        } else {
          footerEl.innerHTML = '<div class="fallback-footer">¬© Sarat Government Office ‚Äî eDocuments</div>';
        }
      });

      fetch('nav.html')
        .then(res => res.ok ? res.text() : '')
        .then(navHtml => {
          const navTarget = document.getElementById('main-nav');
          if (navTarget && navHtml) navTarget.innerHTML = navHtml;
        })
        .catch(() => {});
    }

    // ----- START -----
    loadHeaderFooter();
    loadAllCSVTables();
    initTabs();

    // Mobile dropdown logic (global, unaffected)
    document.addEventListener("click", function (e) {
      if (e.target.classList.contains("menu-toggle")) {
        const menu = document.querySelector(".menu");
        if (menu) menu.classList.toggle("open");
      }
      const dropdownLink = e.target.closest(".dropdown > a");
      if (dropdownLink && window.innerWidth <= 900) {
        e.preventDefault();
        dropdownLink.parentElement.classList.toggle("open");
      }
    });

  })();
</script>

</body>
</html>
